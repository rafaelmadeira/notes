<div class="note" id="<%= dom_id(note) %>">
  <div class="note-header">
    <%= button_to toggle_star_note_path(note), 
                  class: "star-button #{note.starred ? 'starred' : ''}", 
                  method: :post,
                  form: { style: 'display: inline-block' } do %>
      <%= note.starred ? "â˜…" : "â˜†" %>
    <% end %>
  </div>
  <div class="content">
    <%= format_note_content(note.content) %>
  </div>
  <div class="note-actions">
    <%= link_to format_timestamp(note.created_at), 
                note_path(note),
                class: "note-permalink" %>
    <button class="reply-button" data-note-id="<%= note.id %>" type="button">
      Reply
    </button>
    <% if note.reference_count > 0 %>
      <%= link_to "#{note.reference_count} #{note.reference_count == 1 ? 'reference' : 'references'}", 
                  notes_path(referencing: note.id),
                  class: "reference-count" %>
    <% end %>
    <%= link_to "Edit",
                edit_note_path(note),
                class: "note-action-link" %>
    <%= link_to "Delete", 
                note_path(note), 
                class: "note-action-link delete-link",
                data: { 
                  turbo_method: :delete,
                  turbo_confirm: "Are you sure you want to delete this note?" 
                } %>
  </div>
</div>
